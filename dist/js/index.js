"use strict";angular.module("app",["ui.router","ngCookies","validation","ngAnimate","lazyload"]),angular.module("app").service("cache",["$cookies",function(t){this.put=function(e,a){t.put(e,a)},this.get=function(e){return t.get(e)},this.remove=function(e){t.remove(e)}}]),angular.module("app").value("dist",[]).run(["dist","$http",function(t,e){e.get("data/nav.json",{}).then(function(e){t.nav=e.data})}]),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("main",{url:"/main/:id",templateUrl:"view/main.html",controller:"mainCtrl"}).state("bookcity",{url:"/bookcity/:name",templateUrl:"view/bookcity.html",controller:"bookcityCtr"}).state("zj",{url:"/zj/:id",templateUrl:"view/zj.html",controller:"zjCtr"}).state("xq",{url:"/xq/:id",templateUrl:"view/xq.html",controller:"xqCtrl"}).state("cart",{url:"/cart/:id",templateUrl:"view/cart.html",controller:"cartCtr"}).state("purchasing",{url:"/purchasing/:idx",templateUrl:"view/purchasingpage.html",controller:"purchasingpageCtr"}).state("login",{url:"/login",templateUrl:"view/login.html",controller:"loginCtr"}).state("register",{url:"/register",templateUrl:"view/register.html",controller:"registerCtr"}).state("me",{url:"/me",templateUrl:"view/me.html",controller:"meCtr"}),e.otherwise("main/0")}]),angular.module("app").config(["$validationProvider",function(t){var e={phone:/^1[\d]{10}$/,password:function(t){return(t+"").length>5},required:function(t){return!!t}},a={phone:{success:"",error:"必须是11位手机号"},password:{success:"",error:"长度至少6位"},required:{success:"",error:"不能为空"}};t.setExpression(e).setDefaultMsg(a)}]),angular.module("app").controller("bookcityCtr",["shoucang","$state","$http","$scope",function(t,e,a,n){function r(t){t?angular.forEach(n.filterdataboj,function(e,a,r){t===r[a].id&&(n.filterObj.name=r[a].name,n.filterObj.name)}):delete n.filterObj.name}a.get("data/book.json",{}).then(function(t){n.bookdata=t.data,angular.forEach(n.bookdata,function(t,e,a){for(var r=0;r<a[e].length;r++)n.boobData_all.push(a[e][r])})}),n.orderd=[{des:"des",ord:"pay"}],n.filterdataboj=[{id:"001",name:"移动端"},{id:"002",name:"web"},{id:"003",name:"后端"}],n.boobData_all=[],n.filterObj={},n.filterdata;n.filterdata=n.boobData_all,t.purchasingpage=n.boobData_all,n.tabdata=[{id:"book",name:"书籍类型"},{id:"",name:"价格排序"},{id:"",name:"销量排序"}],n.pushdata=[{id:"",name:"全部"},{id:"002",name:"WEB"},{id:"001",name:"移动端"},{id:"003",name:"后台端"}],n.seclecte=0,n.isShow=!1,n.selected=function(t,e){n.seclecte=t,2==n.seclecte&&("pay"===n.orderd[0].ord?n.orderd[0].ord="newprice":n.orderd[0].ord="pay"),1==n.seclecte&&("des"===n.orderd[0].des?n.orderd[0].des="asc":n.orderd[0].des="des"),0==n.seclecte?(n.isShow=!0,n.actives=!0):(n.isShow=!1,n.actives=!1)},"my"!==e.params.name&&(n.filterObj.name=e.params.name),n.parse=function(t,e){n.isShow=!1,n.actives=!1,r(t),angular.forEach(n.tabdata,function(t){t.id&&(t.name=e)})},n.dd=function(){n.isShow=!1,n.actives=!1},n.back=function(){window.history.back()}}]),angular.module("app").controller("cartCtr",["$http","$q","$scope",function(t,e,a){}]),angular.module("app").controller("loginCtr",["cache","$state","$scope",function(t,e,a){a.submit=function(){e.go("main",{id:"0"})},a.user={phone:""},a.$watch("user.phone",function(e){e&&t.put("username",e)})}]),angular.module("app").controller("mainCtrl",["dist","$http","$q","$scope",function(t,e,a,n){e.get("data/autoImg_data.json",{}).then(function(t){setTimeout(function(){n.$apply(function(){n.autoimg=t.data})},10)}),n.nav=t.nav}]),angular.module("app").controller("meCtr",["$http","$q","$scope",function(t,e,a){a.fh=function(){window.history.back()}}]),angular.module("app").controller("purchasingpageCtr",["$state","dist","$scope","$http",function(t,e,a,n){var r=new Swiper("#bookimg",{observer:"true",roundLengths:!0,initialSlide:t.params.idx,pagination:".swiper-pagination",effect:"coverflow",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",coverflow:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0}}),o=new Swiper("#info",{roundLengths:!0,noSwiping:!0,noSwipingClass:"stop-swiping",observer:"true",effect:"fade",fade:{crossFade:!0}});r.params.control=o,a.back=function(){window.history.back()},a.purdata=[],n.get("data/book.json",{}).then(function(t){a.bookdata=t.data,angular.forEach(a.bookdata,function(t,e,n){for(var r=0;r<n[e].length;r++)a.purdata.push(n[e][r])})})}]),angular.module("app").controller("registerCtr",["$state","$scope",function(t,e){e.submit=function(){t.go("login")}}]),angular.module("app").controller("xqCtrl",["shoucang","$http","$q","$scope",function(t,e,a,n){function r(e){e+=1,angular.forEach(n.rmdata,function(a,n,r){var o=parseInt(r[n].id);if(e===o)if(""!=t.rmdata)for(var i=0;i<t.rmdata.length&&(t.rmdata[i].id!==r[n].id&&1!==r[n].state);i++)t.rmdata.push(r[n]),r[n].state=1;else t.rmdata.push(r[n])})}function o(e){angular.forEach(n.TCdata,function(a,n,r){var o=parseInt(r[n].id);if(e===o)if(""!=t.dtdata)for(var i=0;i<t.dtdata.length&&(t.dtdata[i].id!==r[n].id&&1!==r[n].state);i++)t.dtdata.push(r[n]),r[n].state=1;else t.dtdata.push(r[n])})}n.tabdata=[{name:"动态"},{name:"热门"},{name:"发现"}],e.get("data/shujidata.json",{}).then(function(t){n.TCdata=t.data}),e.get("data/remendata.json",{}).then(function(t){n.rmdata=t.data}),e.get("data/found.json",{}).then(function(t){n.fxdata=t.data}),n.tabc=function(t){n.act=t,n.path="image/星.png",r(t)},n.pushB=function(t,e){n.clied=t,e.stopPropagation()},n.cbox=function(t){n.sled=-1,t.stopPropagation()},n.dtcli=function(t,e){n.sled=t,e.stopPropagation()},n.inter=function(){n.sled=-1},n.fly=function(t){o(t),n.sled=-1}}]),angular.module("app").controller("zjCtr",["shoucang","$http","$q","$scope",function(t,e,a,n){n.tabdata=[{name:"动态"},{name:"热门"},{name:"发现"}],n.dongtdata=t.dtdata,e.get("data/found.json",{}).then(function(t){n.foundData=t.data});var r=t.rmdata;angular.forEach(r,function(t,e,a){console.log(a[e].heart="image/星.png")}),n.remdata=r,setTimeout(function(){""==n.remdata?n.tg=!0:n.tg=!1,n.$apply()},100),setTimeout(function(){""==n.dongtdata?n.hide=!0:n.hide=!1,n.$apply()},100)}]),angular.module("app").directive("appTab",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/apptab.html"}}]),angular.module("app").directive("appAutoimg",[function(){return{restrict:"A",replace:!0,scope:{data:"="},templateUrl:"view/template/autoimg.html",link:function(t,e,a){new Swiper("#autoimg",{autoplayDisableOnInteraction:!1,autoplay:5e3,loop:"true",observer:"true",observeParents:!0})}}}]),angular.module("app").directive("appContent",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/content.html"}}]),angular.module("app").directive("appCourse",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/course.html"}}]),angular.module("app").directive("appNav",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/nav.html"}}]),angular.module("app").directive("appPldata",[function(){return{priority:0,restrict:"A",replace:!0,scope:{bookdata:"=",filterObj:"=",order:"=",orderlx:"="},templateUrl:"view/template/pldata.html",link:function(t,e,a){}}}]),angular.module("app").directive("appPushbox",["$animate",function(t){return{restrict:"A",replace:!0,scope:{hide:"=",isClick:"&"},templateUrl:"view/template/pushbox.html"}}]),angular.module("app").directive("appHead",["$timeout","$window","cache","$state",function(t,e,a,n){return{restrict:"A",replace:!0,templateUrl:"view/template/search.html",link:function(t,r,o){t.hide=!0,t.login=function(){a.get("username")||n.go("login")},a.get("username")?t.name=a.get("username"):t.name="去登录";r[0].nextElementSibling;setTimeout(function(){t.width=o.$$element[0].nextElementSibling.clientHeight},10),e.document.onscroll=function(){t.$apply(function(){e.document.body.scrollTop>t.width+100?t.hide=!1:t.hide=!0})}}}}]),angular.module("app").directive("appSheet",["$state","$http",function(t,e){return{restrict:"A",replace:!0,templateUrl:"view/template/sheet.html",link:function(a,n,r){e.get("data/foot.json",{}).then(function(t){a.bookdata=t.data}),a.flag=0,a.$watch(t.params.id,function(t){a.flag=t})}}}]),angular.module("app").directive("appTabcontent",["cache","shoucang","$http",function(t,e,a){return{restrict:"A",replace:!0,scope:{text:"@",dttext:"@",tabdt:"=",tabrm:"=",tabfx:"=",active:"=",onCli:"&",pathimg:"=",onTab:"&",selected:"=",toggle:"=",onNinter:"&",onFlytf:"&",show:"=",onClosebox:"&"},templateUrl:"view/template/tabcontent.html",link:function(e,a,n){""==t.get("tabid")?e.idx=1:e.idx=t.get("tabid");new Swiper(".swiper-container",{resistanceRatio:0,initialSlide:e.idx,scrollbar:".swiper-scrollbar",scrollbarDraggable:!0,scrollbarSnapOnRelease:!0,scrollbarHide:!1,onSlideChangeStart:function(e){t.put("tabid",e.activeIndex)}})}}}]),angular.module("app").directive("appTop",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/top.html"}}]),angular.module("app").directive("appTuijian",[function(){return{restrict:"A",replace:!0,templateUrl:"view/template/tuijian.html",link:function(t,e,a){new Swiper("#tuijianauto",{pagination:".swiper-pagination",slidesPerView:2.6,spaceBetween:11,freeMode:!0,slidesOffsetBefore:5,resistanceRatio:.3,slidesOffsetAfter:15})}}}]),angular.module("app").filter("filterByObj",[function(){return function(t,e){var a=[];return angular.forEach(t,function(t){var n=!0;for(var r in e)t[r]!==e[r]&&(n=!1);n&&a.push(t)}),a}}]),angular.module("app").filter("filterpx",[function(){return function(t,e,a){var n;return angular.forEach(t,function(r,o,i){function l(n){for(var o in r.positionList)if(e===o){if(n>=t.length-1)return;if("des"==a){if(i[n].positionList[e]>i[n+1].positionList[e]){c=i[n+1];i[n+1]=i[n],i[n]=c}}else if(i[n].positionList[e]<i[n+1].positionList[e]){var c=i[n+1];i[n+1]=i[n],i[n]=c}}if(n<=t.length-1)return l(n+1)}l(0),5==o&&(n=i)}),n}}]),angular.module("app").service("shoucang",[function(){this.rmdata=[],this.dtdata=[],this.purchasingpage}]);